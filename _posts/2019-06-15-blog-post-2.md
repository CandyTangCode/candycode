---
title: 'Reading Tonight: Copulas: An interesting way to generated correlated random variables. (learning how to render equations)'
date: 2019-06-15
permalink: /posts/2019/06/blog-post-4/
tags:
  - Chapter Review
  - Stochastic Simulations 
---
This blog post in a trial to render equations this way so that the problem you see before will not happen. Special Thanks to the package [readme2tex](https://github.com/leegao/readme2tex)

This blog post is nothing but an quick note from reading 'Monte Carlo and Quasi-Monte Carlo Sampling' by Christiane Lemieux. The interesting thing here is the copulas which I have not read about. (The ideas might be used somewhere but unfortunately I have not heard about it until) This is interesting since I have always been wondering about the generation of correlated random variables besides just normal random variables. The difficulty lies in the fact that it is not clear how to correlated two random variables besides just trying to compute the conditional distributions which in itself is extremely difficult most of the time.

I would suggest reading Chapter 2.6 of the book but I would like to note down a simple summary for the future me who might want to read this some day. Consider the fact that I want to generate a set of <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/f9c4988898e7f532b9f826a75014ed3c.svg?invert_in_darkmode" align=middle width=14.999985000000004pt height=22.46574pt/> correlated variable from <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/7b9a0316a2fcd7f01cfd556eedf72e96.svg?invert_in_darkmode" align=middle width=14.999985000000004pt height=22.46574pt/>, where <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/7b9a0316a2fcd7f01cfd556eedf72e96.svg?invert_in_darkmode" align=middle width=14.999985000000004pt height=22.46574pt/> is distribution defined by the CDF <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/7b9a0316a2fcd7f01cfd556eedf72e96.svg?invert_in_darkmode" align=middle width=14.999985000000004pt height=22.46574pt/> (abuse some notation here!)

Now, I can construct <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/20330967be97e322a4497e2215b1ce5d.svg?invert_in_darkmode" align=middle width=84.29454pt height=24.65759999999998pt/> from iid Gaussian distribution with a correlation matrix <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/813cd865c037c89fcdc609b25c465a05.svg?invert_in_darkmode" align=middle width=11.872245000000005pt height=22.46574pt/>. This is just Cholesky decomposition. Then we let <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/e6c6a07c4275b75d7f94c185f11b1a70.svg?invert_in_darkmode" align=middle width=97.61449499999999pt height=26.76201000000001pt/>. Note that since <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/ed35373880183d013fc1bba898b2e3ae.svg?invert_in_darkmode" align=middle width=15.872505000000006pt height=22.46574pt/> is correlated, <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/8ea38e2adf995ba3a8661a5d13c17526.svg?invert_in_darkmode" align=middle width=15.874650000000003pt height=22.46574pt/> are correlated too!. However note that 
<img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/4bfbeabc07f826fd4e240b5d184ab355.svg?invert_in_darkmode" align=middle width=389.069505pt height=26.76201000000001pt/> 

So marginally we have uniform distribution still. Now we can generated <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/3271649e7fcf324561327ddff1c17150.svg?invert_in_darkmode" align=middle width=62.13042pt height=26.76201000000001pt/> which can (hopefully) be correlated!. We can construct really hard example that may be independent but I think usually it is not. However, it did not specify the level of correlation between <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/3271649e7fcf324561327ddff1c17150.svg?invert_in_darkmode" align=middle width=62.13042pt height=26.76201000000001pt/> which I think is much harder to compute. However the sign of the correlation is easy to control since <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/5e16cba094787c1a10e568c61c63a5fe.svg?invert_in_darkmode" align=middle width=11.872245000000005pt height=22.46574pt/>  and <img src="https://rawgit.com/yiliu9090/yiliu9090/master/svgs/7b9a0316a2fcd7f01cfd556eedf72e96.svg?invert_in_darkmode" align=middle width=14.999985000000004pt height=22.46574pt/> are mono-tonic distributions and therefore the sign is preserved. 

We can now generate exponential, hence some gamma random variables that are correlated. Combining it with some kind of rejection sampling may not be difficult if we want to same pairwise correlation since we can do rejection sampling on each of them and throw away those that did not make the cut. This might change the correlation structure though.

Reference 
================
Lemieux, Christiane, Monte Carlo and Quasi-Monte Carlo Sampling, Springer-Verlag New York Inc., 2010, pp. 53â€“54.

